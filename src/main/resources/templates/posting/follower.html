<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Follower</title>
</head>
<body>
<!-- 나를 follow 중 -->
<h1><span th:text="${user.userName}"></span>님의 Follower</h1>
<div th:each = "follow : ${user.followers}">
    <div th:each="img : ${follow.followers.userImgs}">
        <img th:src="${img.prfImgUrl}" alt="프로필 사진" width="100" style="border-radius: 50%; object-fit: cover;">
    </div>
    <p th:text="${follow.followers.userName}"></p>
    <p th:text="${follow.followers.userEmail}"></p>
    <button class="followerBtn"
            th:data-followee="${user.userId}"
            th:data-follower="${follow.followers.userId}">팔로우</button>
</div>
</body>

<script>
    const followerBtns = document.querySelectorAll(".followerBtn");
    const USER_ID = '[[${user.userId}]]';

    followerBtns.forEach(button => {
        button.addEventListener("click",async function(){
        const followerId = this.dataset.follower;
        const followeeId = this.dataset.followee;
        const url = `/posting/${USER_ID}/followee.do`; // 백틱!!!!
        const response = await fetch(url,{method:'POST',
            headers: {'Content-Type': 'application/json'},
            body : JSON.stringify({
                followeeId: followeeId,
                followerId: followerId
            })
        });
        if (response.ok){alert("팔로우 성공")}
        });
    });


</script>

</html>